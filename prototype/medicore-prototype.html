<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MediCore EMR - Dr. Prakash</title>
    <style>
        /* Professional Medical UI Design */
        :root {
            --primary-color: #0066cc;
            --primary-dark: #004c99;
            --primary-light: #e6f2ff;
            --secondary-color: #2c3e50;
            --success-color: #00b894;
            --danger-color: #d63031;
            --warning-color: #fdcb6e;
            --info-color: #74b9ff;
            --bg-color: #f5f7fa;
            --bg-secondary: #ffffff;
            --border-color: #dfe6e9;
            --text-primary: #2d3436;
            --text-secondary: #636e72;
            --text-light: #b2bec3;
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.1);
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.12);
            --touch-target: 56px;
            --spacing-xs: 8px;
            --spacing-sm: 12px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
            --border-radius: 12px;
            --border-radius-sm: 8px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Helvetica Neue', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--text-primary);
            font-size: 16px;
            overflow: hidden;
            line-height: 1.6;
        }

        .app-container {
            display: grid;
            grid-template-columns: 320px 1fr;
            height: 100vh;
            overflow: hidden;
        }

        /* Professional Sidebar */
        .sidebar {
            background: linear-gradient(180deg, #1e3c72 0%, #2a5298 100%);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
        }

        .sidebar-header {
            padding: var(--spacing-xl) var(--spacing-lg);
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-sm);
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: var(--border-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: var(--shadow-md);
        }

        .sidebar-header h1 {
            font-size: 26px;
            font-weight: 700;
            color: white;
            margin-bottom: 4px;
            letter-spacing: -0.5px;
        }

        .sidebar-header p {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 500;
        }

        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: var(--spacing-lg);
        }

        .sidebar-content::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        .sidebar-content::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
        }

        /* Main Content */
        .main-content {
            background: var(--bg-color);
            overflow-y: auto;
            padding: var(--spacing-xl);
        }

        .main-content::-webkit-scrollbar {
            width: 8px;
        }

        .main-content::-webkit-scrollbar-track {
            background: var(--bg-color);
        }

        .main-content::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }

        /* Professional Buttons */
        .btn {
            min-height: var(--touch-target);
            padding: 0 var(--spacing-xl);
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            box-shadow: var(--shadow-sm);
            letter-spacing: 0.3px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #00b894 0%, #00cec9 100%);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #d63031 0%, #e17055 100%);
            color: white;
        }

        .btn-outline {
            background: white;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            box-shadow: none;
        }

        .btn-outline:hover {
            background: var(--primary-light);
        }

        .btn-block {
            width: 100%;
        }

        .btn-lg {
            min-height: 64px;
            font-size: 18px;
            border-radius: var(--border-radius);
        }

        /* Professional Input Fields */
        .input-field {
            min-height: 52px;
            padding: var(--spacing-md) var(--spacing-lg);
            font-size: 16px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            width: 100%;
            transition: all 0.3s ease;
            background: white;
            color: var(--text-primary);
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px var(--primary-light);
        }

        .input-field::placeholder {
            color: var(--text-light);
        }

        .input-group {
            margin-bottom: var(--spacing-lg);
        }

        .input-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
            color: var(--text-primary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Professional Cards */
        .card {
            background: white;
            border-radius: var(--border-radius);
            padding: var(--spacing-xl);
            box-shadow: var(--shadow-md);
            margin-bottom: var(--spacing-lg);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
        }

        .card-header {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-md);
            border-bottom: 2px solid var(--border-color);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        /* Stats Cards */
        .stats-card {
            background: white;
            border-radius: var(--border-radius);
            padding: var(--spacing-xl);
            box-shadow: var(--shadow-md);
            border-left: 4px solid var(--primary-color);
            transition: all 0.3s ease;
        }

        .stats-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .stats-card h3 {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: var(--spacing-sm);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }

        .stats-card p {
            font-size: 36px;
            font-weight: 700;
            line-height: 1;
        }

        .stats-card.primary {
            border-left-color: var(--primary-color);
        }

        .stats-card.primary p {
            color: var(--primary-color);
        }

        .stats-card.warning {
            border-left-color: var(--warning-color);
        }

        .stats-card.warning p {
            color: #e17055;
        }

        .stats-card.success {
            border-left-color: var(--success-color);
        }

        .stats-card.success p {
            color: var(--success-color);
        }

        /* Patient List */
        .patient-list {
            list-style: none;
        }

        .patient-list-item {
            padding: var(--spacing-lg);
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: var(--border-radius-sm);
            margin-bottom: var(--spacing-xs);
        }

        .patient-list-item:hover {
            background: var(--primary-light);
            transform: translateX(4px);
        }

        .patient-list-item:active {
            background: #cce5ff;
        }

        .patient-info h3 {
            font-size: 17px;
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--text-primary);
        }

        .patient-info p {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Quick Select Buttons */
        .quick-select-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--spacing-sm);
            margin: var(--spacing-md) 0;
        }

        .quick-select-btn {
            min-height: 72px;
            padding: var(--spacing-md);
            font-size: 15px;
            font-weight: 600;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .quick-select-btn:hover {
            border-color: var(--primary-color);
            background: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }

        .quick-select-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: transparent;
            box-shadow: var(--shadow-md);
        }

        /* Form Grid */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-lg);
        }

        .form-grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--spacing-lg);
        }

        /* Search Box */
        .search-box {
            position: relative;
            margin-bottom: var(--spacing-lg);
        }

        .search-box input {
            padding-left: 52px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: white;
        }

        .search-box input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .search-box input:focus {
            background: white;
            color: var(--text-primary);
            border-color: white;
        }

        .search-icon {
            position: absolute;
            left: var(--spacing-lg);
            top: 50%;
            transform: translateY(-50%);
            font-size: 20px;
            color: rgba(255, 255, 255, 0.6);
        }

        /* Badge */
        .badge {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .badge-primary {
            background: var(--primary-light);
            color: var(--primary-color);
        }

        .badge-success {
            background: #d1fae5;
            color: var(--success-color);
        }

        .badge-warning {
            background: #fef3c7;
            color: #e17055;
        }

        /* Medicine List */
        .medicine-item {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: var(--border-radius-sm);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
            border-left: 4px solid var(--primary-color);
            box-shadow: var(--shadow-sm);
        }

        .medicine-item h4 {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            color: var(--text-primary);
        }

        .medicine-item p {
            font-size: 14px;
            color: var(--text-secondary);
            margin: 4px 0;
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .mb-3 {
            margin-bottom: var(--spacing-lg);
        }

        .mb-4 {
            margin-bottom: var(--spacing-xl);
        }

        .mt-3 {
            margin-top: var(--spacing-lg);
        }

        .mt-4 {
            margin-top: var(--spacing-xl);
        }

        .flex {
            display: flex;
        }

        .flex-between {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .gap-3 {
            gap: var(--spacing-lg);
        }

        .text-center {
            text-align: center;
        }

        /* Current Patient Card */
        #currentPatientCard {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
        }

        #currentPatientCard h3 {
            color: white;
        }

        #currentPatientInfo p {
            color: rgba(255, 255, 255, 0.9);
        }

        /* Billing Total Card */
        .billing-total {
            background: linear-gradient(135deg, #00b894 0%, #00cec9 100%);
            border: none;
            color: white;
            box-shadow: var(--shadow-lg);
        }

        .billing-total h3,
        .billing-total p {
            color: white;
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card {
            animation: fadeIn 0.5s ease;
        }

        /* Responsive */
        @media (min-width: 1024px) and (max-width: 1366px) {
            .app-container {
                grid-template-columns: 340px 1fr;
            }
        }

        @media (min-width: 834px) and (max-width: 1194px) {
            .app-container {
                grid-template-columns: 300px 1fr;
            }
            
            .btn {
                font-size: 15px;
            }
            
            .input-field {
                font-size: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo-container">
                    <div class="logo-icon">‚öïÔ∏è</div>
                    <div>
                        <h1>MediCore</h1>
                        <p>Dr. Prakash's Clinic</p>
                    </div>
                </div>
            </div>

            <div class="sidebar-content">
                <button class="btn btn-primary btn-block mb-3" onclick="showView('registration')">
                    ‚ûï New Patient
                </button>

                <button class="btn btn-outline btn-block mb-3" onclick="showView('dashboard')" style="background: rgba(255,255,255,0.1); color: white; border-color: rgba(255,255,255,0.3);">
                    üè† Dashboard
                </button>

                <div class="search-box">
                    <span class="search-icon">üîç</span>
                    <input 
                        type="text" 
                        class="input-field" 
                        placeholder="Search patients..."
                        oninput="searchPatients(this.value)"
                    >
                </div>

                <div id="patientList"></div>

                <div id="currentPatientCard" class="card hidden">
                    <h3 style="font-size: 15px; font-weight: 700; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 1px;">Current Patient</h3>
                    <div id="currentPatientInfo"></div>
                    <button class="btn btn-outline btn-block mt-3" onclick="showView('history')" style="background: rgba(255,255,255,0.1); color: white; border-color: rgba(255,255,255,0.3);">
                        üìã View History
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard View -->
            <div id="dashboardView">
                <h2 class="card-header" style="background: white; padding: var(--spacing-xl); border-radius: var(--border-radius); box-shadow: var(--shadow-md); border: none;">
                    üìä Dashboard Overview
                </h2>
                
                <div class="form-grid-3 mb-4">
                    <div class="stats-card primary">
                        <h3>Today's Patients</h3>
                        <p id="todayPatientsCount">0</p>
                    </div>
                    <div class="stats-card warning">
                        <h3>Follow-ups Today</h3>
                        <p id="followupsCount">0</p>
                    </div>
                    <div class="stats-card success">
                        <h3>Today's Collection</h3>
                        <p id="collectionAmount">‚Çπ0</p>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-header">üë• Recent Patients</h3>
                    <ul class="patient-list" id="recentPatientsList"></ul>
                </div>
            </div>

            <!-- Patient Registration View -->
            <div id="registrationView" class="hidden">
                <div class="card">
                    <h2 class="card-header">‚ûï New Patient Registration</h2>
                    
                    <form onsubmit="registerPatient(event)">
                        <div class="form-grid">
                            <div class="input-group">
                                <label class="input-label">Patient Name *</label>
                                <input type="text" class="input-field" id="patientName" required placeholder="Enter full name">
                            </div>
                            <div class="input-group">
                                <label class="input-label">Age *</label>
                                <input type="number" class="input-field" id="patientAge" required placeholder="Enter age" min="0" max="150">
                            </div>
                        </div>

                        <div class="form-grid">
                            <div class="input-group">
                                <label class="input-label">Gender *</label>
                                <select class="input-field" id="patientGender" required>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label class="input-label">Phone Number *</label>
                                <input type="tel" class="input-field" id="patientPhone" required placeholder="10-digit mobile number" pattern="[0-9]{10}">
                            </div>
                        </div>

                        <div class="input-group">
                            <label class="input-label">Email Address</label>
                            <input type="email" class="input-field" id="patientEmail" placeholder="patient@example.com (optional)">
                        </div>

                        <div class="input-group">
                            <label class="input-label">Address</label>
                            <textarea class="input-field" id="patientAddress" placeholder="Enter complete address (optional)" rows="3"></textarea>
                        </div>

                        <div class="flex gap-3 mt-4">
                            <button type="submit" class="btn btn-primary btn-block btn-lg">‚úÖ Register Patient</button>
                            <button type="button" class="btn btn-outline btn-lg" onclick="showView('dashboard')">‚ùå Cancel</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Case Sheet View -->
            <div id="casesheetView" class="hidden">
                <div class="card">
                    <div class="flex-between mb-3">
                        <div id="casesheetPatientInfo"></div>
                        <span class="badge badge-success" style="font-size: 16px; padding: 10px 20px;">üÜï New Visit</span>
                    </div>

                    <form onsubmit="saveCaseSheet(event)">
                        <!-- Chief Complaints -->
                        <div class="input-group">
                            <label class="input-label">ü©∫ Chief Complaints *</label>
                            <div class="quick-select-grid" id="complaintsGrid"></div>
                        </div>

                        <!-- Vitals -->
                        <div class="input-group">
                            <label class="input-label">üíì Vital Signs</label>
                            <div class="form-grid-3">
                                <input type="text" class="input-field" id="vitalBP" placeholder="BP (e.g., 120/80)">
                                <input type="text" class="input-field" id="vitalTemp" placeholder="Temp (¬∞F)">
                                <input type="text" class="input-field" id="vitalPulse" placeholder="Pulse (bpm)">
                            </div>
                            <div class="form-grid mt-3">
                                <input type="text" class="input-field" id="vitalSpO2" placeholder="SpO2 (%)">
                                <input type="text" class="input-field" id="vitalWeight" placeholder="Weight (kg)">
                            </div>
                        </div>

                        <!-- History -->
                        <div class="input-group">
                            <label class="input-label">üìù History of Present Illness</label>
                            <textarea class="input-field" id="history" rows="3" placeholder="Detailed history..."></textarea>
                        </div>

                        <!-- Examination -->
                        <div class="input-group">
                            <label class="input-label">üîç Physical Examination</label>
                            <textarea class="input-field" id="examination" rows="3" placeholder="Examination findings..."></textarea>
                        </div>

                        <!-- Diagnosis -->
                        <div class="input-group">
                            <label class="input-label">üéØ Diagnosis *</label>
                            <div class="quick-select-grid" id="diagnosisGrid"></div>
                        </div>

                        <!-- Notes -->
                        <div class="input-group">
                            <label class="input-label">üìå Additional Notes</label>
                            <textarea class="input-field" id="notes" rows="2" placeholder="Any additional notes..."></textarea>
                        </div>

                        <!-- Follow-up Date -->
                        <div class="input-group">
                            <label class="input-label">üìÖ Follow-up Date</label>
                            <input type="date" class="input-field" id="followupDate">
                        </div>

                        <button type="submit" class="btn btn-primary btn-block btn-lg mt-4">
                            ‚û°Ô∏è Save & Continue to Prescription
                        </button>
                    </form>
                </div>
            </div>

            <!-- Prescription View -->
            <div id="prescriptionView" class="hidden">
                <div class="card">
                    <h2 class="card-header">üíä E-Prescription</h2>

                    <div class="input-group">
                        <label class="input-label">Quick Select Medicines</label>
                        <div class="quick-select-grid" id="medicinesGrid"></div>
                    </div>

                    <button class="btn btn-outline btn-block mt-3" onclick="toggleCustomMedicine()">
                        ‚ûï Add Custom Medicine
                    </button>

                    <div id="customMedicineForm" class="card mt-3 hidden" style="background: var(--primary-light);">
                        <div class="form-grid">
                            <div class="input-group">
                                <label class="input-label">Medicine Name</label>
                                <input type="text" class="input-field" id="customMedicineName" placeholder="Enter medicine name">
                            </div>
                            <div class="input-group">
                                <label class="input-label">Dosage</label>
                                <input type="text" class="input-field" id="customMedicineDosage" placeholder="e.g., 500mg">
                            </div>
                        </div>
                        <div class="form-grid-3">
                            <div class="input-group">
                                <label class="input-label">Frequency</label>
                                <select class="input-field" id="customMedicineFrequency">
                                    <option value="">Select</option>
                                    <option value="OD">OD (Once daily)</option>
                                    <option value="BD">BD (Twice daily)</option>
                                    <option value="TDS">TDS (Three times)</option>
                                    <option value="QID">QID (Four times)</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label class="input-label">Duration</label>
                                <select class="input-field" id="customMedicineDuration">
                                    <option value="">Select</option>
                                    <option value="3 days">3 days</option>
                                    <option value="5 days">5 days</option>
                                    <option value="7 days">7 days</option>
                                    <option value="10 days">10 days</option>
                                    <option value="15 days">15 days</option>
                                    <option value="30 days">30 days</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label class="input-label">Instructions</label>
                                <select class="input-field" id="customMedicineInstructions">
                                    <option value="">Select</option>
                                    <option value="Before food">Before food</option>
                                    <option value="After food">After food</option>
                                    <option value="With food">With food</option>
                                </select>
                            </div>
                        </div>
                        <button class="btn btn-primary btn-block mt-3" onclick="addCustomMedicine()">‚úÖ Add Medicine</button>
                    </div>

                    <div id="selectedMedicinesList" class="mt-4"></div>

                    <div class="flex gap-3 mt-4 hidden" id="prescriptionActions">
                        <button class="btn btn-success btn-block btn-lg" onclick="generatePrescription()">
                            üìÑ Generate PDF
                        </button>
                        <button class="btn btn-primary btn-lg" onclick="generatePrescription()">
                            üì± Send WhatsApp
                        </button>
                    </div>
                </div>
            </div>

            <!-- Billing View -->
            <div id="billingView" class="hidden">
                <div class="card">
                    <h2 class="card-header">üí∞ Billing & Payment</h2>

                    <form onsubmit="saveBilling(event)">
                        <div class="form-grid">
                            <div class="input-group">
                                <label class="input-label">Consultation Fee (‚Çπ)</label>
                                <input type="number" class="input-field" id="consultationFee" value="500" min="0" step="0.01" oninput="calculateTotal()">
                            </div>
                            <div class="input-group">
                                <label class="input-label">Procedure Charges (‚Çπ)</label>
                                <input type="number" class="input-field" id="procedureCharges" value="0" min="0" step="0.01" oninput="calculateTotal()">
                            </div>
                        </div>

                        <div class="card mt-3 billing-total">
                            <div class="flex-between">
                                <h3 style="font-size: 22px; font-weight: 700;">Total Amount</h3>
                                <p style="font-size: 40px; font-weight: 700;" id="totalAmount">‚Çπ500.00</p>
                            </div>
                        </div>

                        <div class="form-grid mt-3">
                            <div class="input-group">
                                <label class="input-label">Payment Mode</label>
                                <select class="input-field" id="paymentMode">
                                    <option value="Cash">üíµ Cash</option>
                                    <option value="Card">üí≥ Card</option>
                                    <option value="UPI">üì± UPI</option>
                                    <option value="Net Banking">üè¶ Net Banking</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label class="input-label">Payment Status</label>
                                <select class="input-field" id="paymentStatus">
                                    <option value="Paid">‚úÖ Paid</option>
                                    <option value="Pending">‚è≥ Pending</option>
                                    <option value="Partial">‚ö†Ô∏è Partial</option>
                                </select>
                            </div>
                        </div>

                        <div class="flex gap-3 mt-4">
                            <button type="submit" class="btn btn-success btn-block btn-lg">‚úÖ Record Payment</button>
                            <button type="button" class="btn btn-outline btn-lg" onclick="printReceipt()">üñ®Ô∏è Print Receipt</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Patient History View -->
            <div id="historyView" class="hidden">
                <div class="card">
                    <h2 class="card-header">üìã Visit History</h2>
                    <div id="historyList"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample Data Storage
        let patients = [
            { id: 1, code: 'P000001', name: 'Ramesh Kumar', age: 45, gender: 'Male', phone: '9876543210', email: 'ramesh@example.com' },
            { id: 2, code: 'P000002', name: 'Priya Sharma', age: 32, gender: 'Female', phone: '9876543211', email: 'priya@example.com' },
            { id: 3, code: 'P000003', name: 'Suresh Patil', age: 58, gender: 'Male', phone: '9876543212', email: 'suresh@example.com' }
        ];

        let visits = [];
        let currentPatient = null;
        let currentVisit = null;
        let selectedComplaints = [];
        let selectedDiagnoses = [];
        let selectedMedicines = [];

        const complaints = ['Fever', 'Cough', 'Breathless', 'Joint pains', 'Abdominal pain', 'General weakness'];
        const diagnoses = ['Viral fever', 'Diabetes', 'Hypertension', 'CKD'];
        const medicines = [
            { name: 'Crocin', dosage: '500mg', frequency: 'TDS', duration: '3 days', instructions: 'After food' },
            { name: 'Voveran', dosage: '50mg', frequency: 'BD', duration: '5 days', instructions: 'After food' },
            { name: 'Glykind-M', dosage: '500mg', frequency: 'BD', duration: '30 days', instructions: 'Before food' },
            { name: 'Cap Omez', dosage: '20mg', frequency: 'OD', duration: '7 days', instructions: 'Before food' },
            { name: 'Becasule', dosage: '1 cap', frequency: 'OD', duration: '30 days', instructions: 'After food' }
        ];

        window.onload = function() {
            renderDashboard();
            renderPatientList();
            renderComplaintsGrid();
            renderDiagnosisGrid();
            renderMedicinesGrid();
        };

        function showView(viewName) {
            const views = ['dashboard', 'registration', 'casesheet', 'prescription', 'billing', 'history'];
            views.forEach(view => {
                document.getElementById(view + 'View').classList.add('hidden');
            });
            document.getElementById(viewName + 'View').classList.remove('hidden');
        }

        function renderDashboard() {
            document.getElementById('todayPatientsCount').textContent = patients.length;
            document.getElementById('followupsCount').textContent = '0';
            document.getElementById('collectionAmount').textContent = '‚Çπ0';

            const recentList = document.getElementById('recentPatientsList');
            recentList.innerHTML = patients.map(p => `
                <li class="patient-list-item" onclick="selectPatient(${p.id})">
                    <div class="patient-info">
                        <h3>${p.name}</h3>
                        <p>${p.age} years ‚Ä¢ ${p.gender} ‚Ä¢ ${p.phone}</p>
                    </div>
                    <span class="badge badge-primary">${p.code}</span>
                </li>
            `).join('');
        }

        function renderPatientList() {
            const list = document.getElementById('patientList');
            list.innerHTML = `
                <ul class="patient-list">
                    ${patients.slice(0, 5).map(p => `
                        <li class="patient-list-item" onclick="selectPatient(${p.id})">
                            <div class="patient-info">
                                <h3>${p.name}</h3>
                                <p>${p.age}y ‚Ä¢ ${p.gender}</p>
                            </div>
                        </li>
                    `).join('')}
                </ul>
            `;
        }

        function searchPatients(query) {
            if (query.length < 2) {
                renderPatientList();
                return;
            }

            const filtered = patients.filter(p => 
                p.name.toLowerCase().includes(query.toLowerCase()) ||
                p.phone.includes(query) ||
                p.code.includes(query)
            );

            const list = document.getElementById('patientList');
            list.innerHTML = `
                <ul class="patient-list">
                    ${filtered.map(p => `
                        <li class="patient-list-item" onclick="selectPatient(${p.id})">
                            <div class="patient-info">
                                <h3>${p.name}</h3>
                                <p>${p.age}y ‚Ä¢ ${p.gender} ‚Ä¢ ${p.phone}</p>
                            </div>
                            <span class="badge badge-primary">${p.code}</span>
                        </li>
                    `).join('')}
                </ul>
            `;
        }

        function selectPatient(patientId) {
            currentPatient = patients.find(p => p.id === patientId);
            
            document.getElementById('currentPatientCard').classList.remove('hidden');
            document.getElementById('currentPatientInfo').innerHTML = `
                <p style="font-size: 18px; font-weight: 700;">${currentPatient.name}</p>
                <p style="font-size: 14px;">${currentPatient.age} years ‚Ä¢ ${currentPatient.gender}</p>
                <p style="font-size: 14px;">${currentPatient.phone}</p>
            `;

            document.getElementById('casesheetPatientInfo').innerHTML = `
                <div>
                    <h2 style="font-size: 26px; font-weight: 700; margin-bottom: 4px;">${currentPatient.name}</h2>
                    <p style="color: var(--text-secondary); font-size: 16px;">${currentPatient.age} years ‚Ä¢ ${currentPatient.gender} ‚Ä¢ ${currentPatient.code}</p>
                </div>
            `;

            showView('casesheet');
        }

        function registerPatient(event) {
            event.preventDefault();

            const newPatient = {
                id: patients.length + 1,
                code: `P${String(patients.length + 1).padStart(6, '0')}`,
                name: document.getElementById('patientName').value,
                age: parseInt(document.getElementById('patientAge').value),
                gender: document.getElementById('patientGender').value,
                phone: document.getElementById('patientPhone').value,
                email: document.getElementById('patientEmail').value
            };

            patients.push(newPatient);
            alert('‚úÖ Patient registered successfully!');
            
            selectPatient(newPatient.id);
            event.target.reset();
        }

        function renderComplaintsGrid() {
            const grid = document.getElementById('complaintsGrid');
            grid.innerHTML = complaints.map(c => `
                <button type="button" class="quick-select-btn" onclick="toggleComplaint('${c}')">
                    ${c}
                </button>
            `).join('');
        }

        function toggleComplaint(complaint) {
            const index = selectedComplaints.indexOf(complaint);
            if (index > -1) {
                selectedComplaints.splice(index, 1);
            } else {
                selectedComplaints.push(complaint);
            }
            updateComplaintsUI();
        }

        function updateComplaintsUI() {
            complaints.forEach(c => {
                const btn = Array.from(document.querySelectorAll('#complaintsGrid button')).find(b => b.textContent.trim() === c);
                if (btn) {
                    if (selectedComplaints.includes(c)) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                }
            });
        }

        function renderDiagnosisGrid() {
            const grid = document.getElementById('diagnosisGrid');
            grid.innerHTML = diagnoses.map(d => `
                <button type="button" class="quick-select-btn" onclick="toggleDiagnosis('${d}')">
                    ${d}
                </button>
            `).join('');
        }

        function toggleDiagnosis(diagnosis) {
            const index = selectedDiagnoses.indexOf(diagnosis);
            if (index > -1) {
                selectedDiagnoses.splice(index, 1);
            } else {
                selectedDiagnoses.push(diagnosis);
            }
            updateDiagnosisUI();
        }

        function updateDiagnosisUI() {
            diagnoses.forEach(d => {
                const btn = Array.from(document.querySelectorAll('#diagnosisGrid button')).find(b => b.textContent.trim() === d);
                if (btn) {
                    if (selectedDiagnoses.includes(d)) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                }
            });
        }

        function saveCaseSheet(event) {
            event.preventDefault();

            if (selectedComplaints.length === 0 || selectedDiagnoses.length === 0) {
                alert('‚ö†Ô∏è Please select at least one complaint and diagnosis');
                return;
            }

            currentVisit = {
                id: visits.length + 1,
                patientId: currentPatient.id,
                date: new Date(),
                complaints: [...selectedComplaints],
                vitals: {
                    bp: document.getElementById('vitalBP').value,
                    temp: document.getElementById('vitalTemp').value,
                    pulse: document.getElementById('vitalPulse').value,
                    spo2: document.getElementById('vitalSpO2').value,
                    weight: document.getElementById('vitalWeight').value
                },
                history: document.getElementById('history').value,
                examination: document.getElementById('examination').value,
                diagnosis: [...selectedDiagnoses],
                notes: document.getElementById('notes').value,
                followupDate: document.getElementById('followupDate').value
            };

            visits.push(currentVisit);
            alert('‚úÖ Case sheet saved successfully!');
            showView('prescription');
        }

        function renderMedicinesGrid() {
            const grid = document.getElementById('medicinesGrid');
            grid.innerHTML = medicines.map((m, i) => `
                <button type="button" class="quick-select-btn" onclick="addMedicine(${i})" style="text-align: left; flex-direction: column; align-items: flex-start; justify-content: center;">
                    <div style="font-weight: 700; margin-bottom: 4px;">${m.name}</div>
                    <div style="font-size: 13px; color: var(--text-secondary);">${m.dosage} ‚Ä¢ ${m.frequency}</div>
                </button>
            `).join('');
        }

        function addMedicine(index) {
            selectedMedicines.push({...medicines[index]});
            renderSelectedMedicines();
        }

        function toggleCustomMedicine() {
            const form = document.getElementById('customMedicineForm');
            form.classList.toggle('hidden');
        }

        function addCustomMedicine() {
            const name = document.getElementById('customMedicineName').value;
            const dosage = document.getElementById('customMedicineDosage').value;
            const frequency = document.getElementById('customMedicineFrequency').value;
            const duration = document.getElementById('customMedicineDuration').value;
            const instructions = document.getElementById('customMedicineInstructions').value;

            if (!name || !dosage) {
                alert('‚ö†Ô∏è Please enter medicine name and dosage');
                return;
            }

            selectedMedicines.push({ name, dosage, frequency, duration, instructions });
            renderSelectedMedicines();
            
            document.getElementById('customMedicineName').value = '';
            document.getElementById('customMedicineDosage').value = '';
            document.getElementById('customMedicineFrequency').value = '';
            document.getElementById('customMedicineDuration').value = '';
            document.getElementById('customMedicineInstructions').value = '';
            toggleCustomMedicine();
        }

        function renderSelectedMedicines() {
            const list = document.getElementById('selectedMedicinesList');
            
            if (selectedMedicines.length === 0) {
                list.innerHTML = '';
                document.getElementById('prescriptionActions').classList.add('hidden');
                return;
            }

            document.getElementById('prescriptionActions').classList.remove('hidden');

            list.innerHTML = `
                <h3 class="input-label" style="font-size: 18px; margin-bottom: 16px;">
                    üíä Prescription (${selectedMedicines.length} medicines)
                </h3>
                ${selectedMedicines.map((m, i) => `
                    <div class="medicine-item">
                        <div class="flex-between mb-3">
                            <h4>${i + 1}. ${m.name}</h4>
                            <button class="btn btn-danger" style="min-height: 40px; padding: 8px 16px; font-size: 14px;" onclick="removeMedicine(${i})">
                                ‚ùå Remove
                            </button>
                        </div>
                        <p><strong>Dosage:</strong> ${m.dosage} | <strong>Frequency:</strong> ${m.frequency}</p>
                        <p><strong>Duration:</strong> ${m.duration} | <strong>Instructions:</strong> ${m.instructions}</p>
                    </div>
                `).join('')}
            `;
        }

        function removeMedicine(index) {
            selectedMedicines.splice(index, 1);
            renderSelectedMedicines();
        }

        function generatePrescription() {
            if (selectedMedicines.length === 0) {
                alert('‚ö†Ô∏è Please add at least one medicine');
                return;
            }

            alert('‚úÖ Prescription generated successfully!\n\nüìÑ PDF will be generated\nüì± WhatsApp message will be sent');
            showView('billing');
        }

        function calculateTotal() {
            const consultation = parseFloat(document.getElementById('consultationFee').value) || 0;
            const procedure = parseFloat(document.getElementById('procedureCharges').value) || 0;
            const total = consultation + procedure;
            document.getElementById('totalAmount').textContent = `‚Çπ${total.toFixed(2)}`;
        }

        function saveBilling(event) {
            event.preventDefault();
            alert('‚úÖ Payment recorded successfully!\n\nüéâ Visit completed!');
            
            currentPatient = null;
            currentVisit = null;
            selectedComplaints = [];
            selectedDiagnoses = [];
            selectedMedicines = [];
            
            showView('dashboard');
            renderDashboard();
        }

        function printReceipt() {
            alert('üñ®Ô∏è Printing receipt...\n\nPDF receipt will be generated.');
        }
    </script>
</body>
</html>